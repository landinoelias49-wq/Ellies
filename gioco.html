<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Gioco dei Gavettoni</title>
<style>
body { margin:0; overflow:hidden; background:skyblue; font-family:Arial;}
canvas { display:block; margin:auto; background:#87ceeb;}
#score {position:absolute; top:10px; left:10px; font-size:2rem; color:white; text-shadow:2px 2px 5px black;}
#winMessage {position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:4rem; color:yellow; text-shadow:3px 3px 10px black; display:none;}
</style>
</head>
<body>
<div id="score">Punteggio: 0</div>
<div id="winMessage">ELLIES HA VINTO!!! ðŸŽ‰</div>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let score = 0;
const scoreDiv = document.getElementById("score");
const winDiv = document.getElementById("winMessage");

// Aereo e Ellies
let plane = {x:100, y:100, width:150, height:50, dx:3};
let ellies = {x:0, y:0, width:60, height:100};

// Palazzi
const buildings = [];
for(let i=0;i<6;i++){
    let w = 80 + Math.random()*40;
    let h = 150 + Math.random()*200;
    buildings.push({x:50+i*200, y:canvas.height-h, width:w, height:h, destroyed:false});
}

// Gavettoni
const balls = [];

window.addEventListener("keydown",(e)=>{
    if(e.key===" ") balls.push({x:plane.x + plane.width/2, y:plane.y+20, radius:10, dy:7});
});

function drawPlane(){
    // Corpo aereo
    ctx.fillStyle="#777";
    ctx.fillRect(plane.x, plane.y, plane.width, plane.height);
    // Ala
    ctx.fillStyle="#555";
    ctx.fillRect(plane.x+20, plane.y-20, 110, 20);
    // Coda
    ctx.fillStyle="#444";
    ctx.fillRect(plane.x+plane.width-20, plane.y-15, 15, 40);
    // Eliche (rotanti)
    ctx.fillStyle="#222";
    ctx.beginPath();
    ctx.arc(plane.x, plane.y+plane.height/2, 10,0,Math.PI*2);
    ctx.fill();

    // Ellies sopra aereo
    ellies.x = plane.x + plane.width/2 - ellies.width/2;
    ellies.y = plane.y - ellies.height;
    // Corpo
    ctx.fillStyle="white";
    ctx.fillRect(ellies.x, ellies.y, ellies.width, ellies.height);
    // Testa
    ctx.fillStyle="#f1c27d";
    ctx.beginPath();
    ctx.arc(ellies.x + ellies.width/2, ellies.y-20, 30,0,Math.PI*2);
    ctx.fill();
    // Barba
    ctx.strokeStyle="#654321";
    ctx.lineWidth=4;
    ctx.beginPath();
    ctx.arc(ellies.x + ellies.width/2, ellies.y-10, 20,0,Math.PI,false);
    ctx.stroke();
    // Occhi
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(ellies.x + ellies.width/2 -10, ellies.y-25, 5,0,Math.PI*2);
    ctx.arc(ellies.x + ellies.width/2 +10, ellies.y-25, 5,0,Math.PI*2);
    ctx.fill();
    ctx.fillStyle="black";
    ctx.beginPath();
    ctx.arc(ellies.x + ellies.width/2 -10, ellies.y-25, 2,0,Math.PI*2);
    ctx.arc(ellies.x + ellies.width/2 +10, ellies.y-25, 2,0,Math.PI*2);
    ctx.fill();
    // Bocca
    ctx.strokeStyle="red";
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.arc(ellies.x + ellies.width/2, ellies.y-10, 10,0,Math.PI,false);
    ctx.stroke();
}

function drawBuildings(){
    buildings.forEach(b=>{
        if(!b.destroyed){
            ctx.fillStyle="#555";
            ctx.fillRect(b.x,b.y,b.width,b.height);
            // finestre
            ctx.fillStyle="#fffae3";
            for(let wx=5;wx<b.width-10;wx+=20){
                for(let wy=5;wy<b.height-10;wy+=20){
                    ctx.fillRect(b.x+wx,b.y+wy,10,10);
                }
            }
        }
    });
}

function drawBalls(){
    balls.forEach((b,i)=>{
        ctx.fillStyle="blue";
        ctx.beginPath();
        ctx.arc(b.x,b.y,b.radius,0,Math.PI*2);
        ctx.fill();
        b.y += b.dy;

        // Collisione con palazzi
        buildings.forEach(bld=>{
            if(!bld.destroyed && b.x>bld.x && b.x<bld.x+bld.width && b.y-b.radius<bld.y+bld.height && b.y+b.radius>bld.y){
                bld.destroyed=true;
                balls.splice(i,1);
                score += 200;
                scoreDiv.textContent="Punteggio: "+score;
                if(score>=1000){
                    buildings.forEach(b2=>b2.destroyed=true);
                    winDiv.style.display="block";
                }
            }
        });

        // fuori schermo
        if(b.y>canvas.height) balls.splice(i,1);
    });
}

function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // Movimento aereo
    plane.x += plane.dx;
    if(plane.x + plane.width>canvas.width || plane.x<0) plane.dx*=-1;

    drawPlane();
    drawBuildings();
    drawBalls();
    requestAnimationFrame(animate);
}
animate();
</script>
<p style="color:white; position:absolute; bottom:10px; left:10px;">Premi SPAZIO per lanciare i gavettoni</p>
</body>
</html>

  


